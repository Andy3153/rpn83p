# This file defines the hierarchy of menu items using a custom DSL (Domain
# Specific Language). The `tools/compilemenu.py` script parses this file,
# creates an internal representation of strings, identifiers, and other
# references, then generates the Z80 assembly data statements.
#
# Using a DSL to generate Z80 code makes adding, removing, changing, and
# moving menu items very easy. All of the internal identifiers and cross
# references are automatically generated by the `compilemenu.py` compiler.
#
# Grammar (I really should learn something like EBNF or ABNF properly):
#   program = menuconfig menugroup
#   menuconfig = 'MenuConfig' '[' config* ']'
#   config = 'ItemName' value
#     | 'ItemNameId' value
#     | 'ItemHandler' value
#     | 'GroupHandler' value
#   menugroup =  'MenuGroup' groupname grouplabel '[' menurow* ']'
#   menurow = 'MenuRow' '[' menunode*5 ']'
#   menunode = menuitem | menuitemalt | menugroup
#   menuitem = 'MenuItem' itemname itemlabel
#   menuitemalt = 'MenuItemAlt' itemname itemaltname itemlabel
#   handler = printableASCII+
#   nameHandler = printableASCII+
#   backHandler = printableASCII+
#   value = printableASCII+
#   groupname = alpha+
#   itemname = alpha+ | '*'
#   itemaltname = alpha+
#   altName = alpha+
#   grouplabel = alpha+
#   itemlabel = alpha+ | '*'
#   alpha =  printableASCII | fonttag
#   fonttag = '<' printableASCII+ '>'
#
# Lexical parsing rules:
#   - tokens are separated by spaces
#   - newlines are white spaces with no other meaning or behavior
#   - square brackets [ ] means "list of"
#   - '*' indicates a blank MenuItem with no ID constant
#   - comments begin with '#' and continue to the until of the line
#
# Semantics:
#   - groupname,itemname: the display name for the menu group or item
#   - itemaltname: alternative name for the menu item
#   - label: identifier for the node data in the assembly code, also used as
#       prefix for other identifiers (e.g. if the label="mNum", there will be
#       other identifiers such as "mNumId", "mNumNameId").
#   - fonttag: a symbol from the TI-OS Small Font table, e.g. '<Sdegree>'
#   - MenuRow: always has 5 menu nodes

# Define the defaults for blank menu items and menu groups.
MenuConfig [
  ItemName mNullName
  ItemNameId mNullNameId
  ItemHandler mNullHandler
  GroupHandler mGroupHandler
  # NameHandler mNameHandler
]

# Defines the hierarchy of menus.
MenuGroup root mRoot [
  MenuRow [
    # Advanced math functions.
    MenuGroup MATH mMath [
      MenuRow [
        MenuItem X<Scaret>3 mCube
        MenuItem <ScubeR><Sroot>X mCubeRoot
        MenuItem ATN2 mAtan2
      ]
      MenuRow [
        MenuItem 2<Scaret>X mAlog2 # 2^x
        MenuItem LOG2 mLog2 # log_base2(x)
        MenuItem LOGB mLogBase # log_base_x(y)
      ]
    ]
    # Arithmetic functions.
    MenuGroup NUM mNum [
      MenuRow [
        MenuItem <Spercent> mPercent
        MenuItem <Spercent>CH mPercentChange
        MenuItem GCD mGcd
        MenuItem LCM mLcm
        MenuItem PRIM mPrime
      ]
      #MenuRow [
      #  MenuItem PMOD mPrimeMod # for debugging modU32U16
      #]
      MenuRow [
        MenuItem IP mIntPart
        MenuItem FP mFracPart
        MenuItem FLR mFloor
        MenuItem CEIL mCeil
        MenuItem NEAR mNear
      ]
      MenuRow [
        MenuItem ABS mAbs
        MenuItem SIGN mSign
        MenuItem MOD mMod
        MenuItem MIN mMin
        MenuItem MAX mMax
      ]
    ]
    MenuGroup PROB mProb [
      MenuRow [
        MenuItem COMB mComb
        MenuItem PERM mPerm
        MenuItem N<Sexclam> mFactorial
        MenuItem RAND mRandom
        MenuItem SEED mRandomSeed
      ]
    ]
    MenuGroup CONV mConv [
      MenuRow [
        MenuItem <Sconvert>DEG mRToD
        MenuItem <Sconvert>RAD mDToR
        MenuItem * *
        MenuItem P<Sconvert>R mPToR
        MenuItem R<Sconvert>P mRToP
      ]
      MenuRow [
        MenuItem <Sconvert>HR mHmsToHr
        MenuItem <Sconvert>HMS mHrToHms
      ]
      # MenuRow [
      #   MenuItem <Sconvert>UNIX mDateToUnixSeconds
      #   menuItem <Sconvert>DATE mUnixSecondsToDate
      #   menuItem LEAP mIsLeapYear
      #   menuItem <Sconvert>SEC mDaysToSeconds
      #   menuItem <Sconvert>DAYS mSecondsToDays
      # ]
    ]
    MenuItem HELP mHelp
  ]
  MenuRow [
    MenuGroup BASE mBase [
      MenuRow [
        MenuItemAlt DEC DEC<Sblock> mDec # decimal
        MenuItemAlt HEX HEX<Sblock> mHex # hexadecimal
        MenuItemAlt OCT OCT<Sblock> mOct # octal
        MenuItemAlt BIN BIN<Sblock> mBin # binary
      ]
      MenuRow [
        MenuItem AND mBitwiseAnd
        MenuItem OR mBitwiseOr
        MenuItem XOR mBitwiseXor
        MenuItem NOT mBitwiseNot # 1's complement
        MenuItem NEG mBitwiseNeg # 2's complement
      ]
      MenuRow [
        MenuItem SL mShiftLeft # shift left logical
        MenuItem SR mShiftRight # shift right logical
        MenuItem RL mRotateLeft # rotate left circular
        MenuItem RR mRotateRight # rotate right circular
      ]
      MenuRow [
        MenuItem B<SplusSign> mBitwiseAdd
        MenuItem B<Sdash> mBitwiseSubt
        MenuItem B<Scross> mBitwiseMult
        MenuItem B<Sslash> mBitwiseDiv
        MenuItem BDIV mBitwiseDiv2
      ]
    ]
    MenuGroup HYP mHyperbolic [
      MenuRow [
        MenuItem * *
        MenuItem SINH mSinh
        MenuItem COSH mCosh
        MenuItem TANH mTanh
        MenuItem * *
      ]
      MenuRow [
        MenuItem * *
        MenuItem ASNH mAsinh
        MenuItem ACSH mAcosh
        MenuItem ATNH mAtanh
        MenuItem * *
      ]
    ]
    MenuGroup STAT mStat [
      MenuRow [
        MenuItem <ScapSigma><SplusSign> mStatPlus
        MenuItem <ScapSigma><Sdash> mStatMinus
        MenuItemAlt ALL<ScapSigma> ALL<Sblock> mStatAllMode
        MenuItemAlt LIN<ScapSigma> LIN<Sblock> mStatLinearMode
        MenuItem CL<ScapSigma> mStatClear
      ]
      MenuRow [
        MenuItem SUM mStatSum
        MenuItem MEAN mStatMean
        MenuItem WMN mStatWeightedMean
        MenuItem N mStatN
      ]
      MenuRow [
        MenuItem SDEV mStatSampleSdev
        MenuItem SCOV mStatSampleCov
        MenuItem PDEV mStatPopSdev
        MenuItem PCOV mStatPopCov
        MenuGroup CFIT mCfit [
          MenuRow [
            MenuItem Y<Sconvert>X mCfitForcastX
            MenuItem X<Sconvert>Y mCfitForcastY
            MenuItem SLOP mCfitSlope
            MenuItem YINT mCfitIntercept
            MenuItem CORR mCfitCorrelation
          ]
          MenuRow [
            MenuItemAlt LINF LIN<Sblock> mCfitLinear
            MenuItemAlt LOGF LOG<Sblock> mCfitLog
            MenuItemAlt EXPF EXP<Sblock> mCfitExp
            MenuItemAlt PWRF PWR<Sblock> mCfitPower
            MenuItem BEST mCfitBest
          ]
        ]
      ]
    ]
    MenuGroup UNIT mUnit [
      MenuRow [
        MenuItem <Sconvert><Stemp>C mFToC
        MenuItem <Sconvert><Stemp>F mCToF
        MenuItem * *
        MenuItem <Sconvert>hPa mInhgToHpa
        MenuItem <Sconvert>iHg mHpaToInhg
      ]
      MenuRow [
        MenuItem <Sconvert>km mMiToKm
        MenuItem <Sconvert>mi mKmToMi
        MenuItem * *
        MenuItem <Sconvert>m mFtToM
        MenuItem <Sconvert>ft mMToFt
      ]
      MenuRow [
        MenuItem <Sconvert>cm mInToCm
        MenuItem <Sconvert>in mCmToIn
        MenuItem * *
        MenuItem <Sconvert><Smu>m mMilToMicron
        MenuItem <Sconvert>mil mMicronToMil
      ]
      MenuRow [
        MenuItem <Sconvert>kg mLbsToKg
        MenuItem <Sconvert>lbs mKgToLbs
        MenuItem * *
        MenuItem <Sconvert>g mOzToG
        MenuItem <Sconvert>oz mGToOz
      ]
      MenuRow [
        MenuItem <Sconvert>L mGalToL
        MenuItem <Sconvert>gal mLToGal
        MenuItem * *
        MenuItem <Sconvert>mL mFlozToMl
        MenuItem <Sconvert>foz mMlToFloz
      ]
      MenuRow [
        MenuItem <Sconvert>kJ mCalToKj
        MenuItem <Sconvert>cal mKjToCal
        MenuItem * *
        MenuItem <Sconvert>kW mHpToKw
        MenuItem <Sconvert>hp mKwToHp
      ]
      # MenuRow [
      #   MenuItem <Sconvert>Lkm mL100kmToMpg
      #   MenuItem <Sconvert>mpg mMpgToL100km
      #   MenuItem * *
      #   MenuItem <Sconvert>kPa mPsiToKpa
      #   MenuItem <Sconvert>psi mKpaToPsi
      # ]
      # MenuRow [
      #   MenuItem <Sconvert>ha mAcreToHectare
      #   MenuItem <Sconvert>acr mHectareToAcre
      #   MenuItem * *
      #   MenuItem * *
      #   MenuItem * *
      # ]
    ]
  ]
  MenuRow [
    MenuGroup CLR mClear [
      MenuRow [
        MenuItem CLX mClearX
        MenuItem CLST mClearStack
        MenuItem CLRG mClearRegs
        MenuItem CL<ScapSigma> mClearStat
      ]
    ]
    MenuGroup MODE mMode [
      MenuRow [
        MenuItemAlt FIX FIX<Sblock> mFix
        MenuItemAlt SCI SCI<Sblock> mSci
        MenuItemAlt ENG ENG<Sblock> mEng
        MenuItemAlt RAD RAD<Sblock> mRad
        MenuItemAlt DEG DEG<Sblock> mDeg
      ]
    ]
    MenuGroup STK mStack [
      MenuRow [
        MenuItem * *
        MenuItem R<SupArrow> mStackRotUp
        MenuItem R<SdownArrow> mStackRotDown
        MenuItem X<Sleft><Sconvert>Y mStackExchangeXY
        MenuItem * *
      ]
    ]
  ]
]
